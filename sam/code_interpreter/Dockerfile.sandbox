# SAM Code Interpreter Sandbox
# Secure Python environment for code execution

FROM python:3.11-slim

# Set up non-root user for security
RUN useradd -m -u 1000 sandbox && \
    mkdir -p /workspace && \
    chown sandbox:sandbox /workspace

# Install essential packages for data analysis
RUN pip install --no-cache-dir \
    numpy==1.24.3 \
    pandas==2.0.3 \
    matplotlib==3.7.2 \
    seaborn==0.12.2 \
    scipy==1.11.1 \
    scikit-learn==1.3.0 \
    plotly==5.15.0 \
    requests==2.31.0 \
    Pillow==10.0.0

# Set working directory
WORKDIR /workspace

# Switch to non-root user
USER sandbox

# Set environment variables for matplotlib (headless)
ENV MPLBACKEND=Agg
ENV PYTHONUNBUFFERED=1

# Default command (will be overridden)
CMD ["python"]
